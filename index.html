<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>EmuTalk ‚Äî Realtime Chat + Activities</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: #111;
      color: white;
    }
    #chat-container, #login-screen {
      display: none;
    }
    .active {
      display: block;
    }
    #chat-header {
      background: #222;
      padding: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    #chat-body {
      display: flex;
      height: calc(100vh - 50px);
    }
    #user-list {
      width: 200px;
      background: #1a1a1a;
      padding: 10px;
      overflow-y: auto;
    }
    #chat-box {
      flex-grow: 1;
      display: flex;
      flex-direction: column;
    }
    #messages {
      flex-grow: 1;
      padding: 10px;
      overflow-y: auto;
      background: #181818;
    }
    #chat-form {
      display: flex;
    }
    #chat-form input {
      flex-grow: 1;
      padding: 10px;
      border: none;
      outline: none;
    }
    #chat-form button {
      background: #444;
      color: white;
      border: none;
      padding: 10px;
      cursor: pointer;
    }
    #activities {
      padding: 10px;
      background: #1e1e1e;
    }
    .settings-panel, .rules-panel {
      position: fixed;
      top: 50px;
      right: 0;
      width: 300px;
      height: calc(100vh - 50px);
      background: #222;
      overflow-y: auto;
      padding: 15px;
      display: none;
      border-left: 2px solid #444;
      z-index: 100;
    }
    .settings-panel h3, .rules-panel h3 {
      margin-top: 0;
    }
    .toggle-btn {
      background: #333;
      color: white;
      padding: 8px 12px;
      border: none;
      cursor: pointer;
      margin-left: 5px;
    }
  </style>
</head>
<body>
  <div id="login-screen" class="active">
    <div style="text-align:center; margin-top: 20vh;">
      <h2>Welcome to EmuTalk</h2>
      <input id="username-input" type="text" placeholder="Enter your name" /><br/><br/>
      <button onclick="startChat()">Join Chat</button>
    </div>
  </div>
  <div id="chat-container">
    <div id="chat-header">
      <strong>EmuTalk</strong>
      <div>
        <button class="toggle-btn" onclick="toggleSettings()">Settings</button>
        <button class="toggle-btn" onclick="toggleRules()">Rules</button>
        <button class="toggle-btn" onclick="changeName()">Change Name</button>
      </div>
    </div>
    <div id="chat-body">
      <div id="user-list"><h4>Users</h4><ul id="users"></ul></div>
      <div id="chat-box">
        <div id="messages"></div>
        <form id="chat-form">
          <input id="msg" type="text" placeholder="Type your message‚Ä¶" required />
          <button type="submit" class="send-btn">Send</button>
        </form>
        <div id="activities">
          <h4>Activities</h4>
          <button onclick="sendActivity('üéâ')">üéâ</button>
          <button onclick="sendActivity('üëç')">üëç</button>
          <button onclick="sendActivity('üí¨')">üí¨</button>
        </div>
      </div>
    </div>
  </div>

  <div class="settings-panel" id="settings-panel">
    <h3>Fun Settings</h3>
    <label><input type="checkbox" onchange="toggleTypingSound(this.checked)"> Typing Sounds</label><br>
    <label><input type="checkbox" onchange="toggleDarkMode(this.checked)"> Dark Mode</label><br>
    <label><input type="checkbox" onchange="toggleRainbowUsernames(this.checked)"> Rainbow Usernames</label><br>
    <label><input type="checkbox" onchange="toggleOnScreenKeyboard(this.checked)"> On-screen Keyboard</label><br>
    <p>More coming soon...</p>
  </div>

  <div class="rules-panel" id="rules-panel">
    <h3>Chat Rules</h3>
    <ul>
      <li>No hate speech, including the N-word</li>
      <li>Swearing is allowed (mature audiences only)</li>
      <li>Don't spam or flood messages</li>
      <li>Be respectful to others</li>
      <li>No impersonation of admins or others</li>
      <li>Keep it fun and creative!</li>
    </ul>
  </div>

  <script>
    let username = localStorage.getItem("emu_username") || "";
    const usersEl = document.getElementById("users");

    if (username) {
      document.getElementById("login-screen").classList.remove("active");
      document.getElementById("chat-container").classList.add("active");
      renderUser();
    }

    function startChat() {
      username = document.getElementById("username-input").value.trim();
      if (username) {
        localStorage.setItem("emu_username", username);
        document.getElementById("login-screen").classList.remove("active");
        document.getElementById("chat-container").classList.add("active");
        renderUser();
      }
    }

    function renderUser() {
      usersEl.innerHTML = `<li>${username}</li>`;
    }

    function changeName() {
      const newName = prompt("New username:");
      if (newName) {
        username = newName.trim();
        localStorage.setItem("emu_username", username);
        renderUser();
      }
    }

    function sendActivity(emoji) {
      const messages = document.getElementById("messages");
      const el = document.createElement("div");
      el.innerText = `${username}: ${emoji}`;
      messages.appendChild(el);
      messages.scrollTop = messages.scrollHeight;
    }

    document.getElementById("chat-form").addEventListener("submit", function(e) {
      e.preventDefault();
      const input = document.getElementById("msg");
      const messages = document.getElementById("messages");
      const el = document.createElement("div");
      el.innerText = `${username}: ${input.value}`;
      messages.appendChild(el);
      input.value = "";
      messages.scrollTop = messages.scrollHeight;
    });

    function toggleSettings() {
      const panel = document.getElementById("settings-panel");
      panel.style.display = panel.style.display === "block" ? "none" : "block";
    }

    function toggleRules() {
      const panel = document.getElementById("rules-panel");
      panel.style.display = panel.style.display === "block" ? "none" : "block";
    }

    function toggleTypingSound(enabled) {
      if (enabled) {
        document.addEventListener("keydown", playTypingSound);
      } else {
        document.removeEventListener("keydown", playTypingSound);
      }
    }

    function playTypingSound() {
      const audio = new Audio("https://www.soundjay.com/button/beep-07.wav");
      audio.volume = 0.2;
      audio.play();
    }

    function toggleDarkMode(enabled) {
      document.body.style.background = enabled ? "#000" : "#111";
    }

    function toggleRainbowUsernames(enabled) {
      // Add rainbow effect logic
    }

    function toggleOnScreenKeyboard(enabled) {
      // Add virtual keyboard logic here
    }
  </script>
</body>
</html>
